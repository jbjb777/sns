<!DOCTYPE html>
<html lang="ko">
<head>
  <script src="https://accounts.google.com/gsi/client" async defer></script>
  
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ë¡œê·¸ì¸ - Sharer</title>
  <link rel="icon" type="image/svg+xml" href="./logo.svg">

  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      margin: 0;
      padding: 0;
      font-family: 'Segoe UI', sans-serif;
      background: #121212;
      color: #fff;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }

    .header {
      background: #1e1e1e;
      border-bottom: 1px solid #333;
      padding: 16px 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .logo-container {
      display: flex;
      align-items: center;
      cursor: pointer;
      transition: transform 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
    }

    .logo-container:hover {
      transform: scale(1.05);
    }

    .logo-svg {
      width: 40px;
      height: 40px;
      margin-right: 12px;
    }

    .logo-text {
      font-size: 24px;
      font-weight: bold;
      color: #fff;
    }

    .main-content {
      flex: 1;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 40px 20px;
    }

    .auth-container {
      background: #1e1e1e;
      border-radius: 16px;
      padding: 40px;
      width: 90%;
      max-width: 400px;
      box-shadow: 0 0 30px rgba(0, 0, 0, 0.6);
    }

    .auth-container h2 {
      text-align: center;
      margin-bottom: 30px;
      color: #fff;
      font-size: 28px;
    }

    .auth-container input {
      width: 100%;
      padding: 12px 20px;
      border-radius: 12px;
      border: 2px solid #333;
      font-size: 16px;
      margin-bottom: 15px;
      outline: none;
      background: #2c2c2c;
      color: #fff;
      box-sizing: border-box;
    }

    .auth-container input:focus {
      border-color: #3663FF;
    }

    .auth-container button {
      width: 100%;
      padding: 12px 24px;
      border-radius: 30px;
      border: none;
      font-size: 16px;
      cursor: pointer;
      background: #3663FF;
      color: #fff;
      margin-bottom: 10px;
      font-weight: 600;
      position: relative;
      overflow: hidden;
      transition: none;
    }

    .auth-container button:active:not(:disabled) {
      animation: clickEffect 0.3s ease forwards;
    }

    @keyframes clickEffect {
      0% { transform: scale(1); }
      50% { transform: scale(0.95); }
      100% { transform: scale(1); }
    }

    .auth-container button:disabled {
      cursor: not-allowed;
      opacity: 0.7;
    }

    .terms-label {
      text-align: left;
      font-size: 14px;
      margin-bottom: 8px;
      color: #aaa;
      font-weight: 600;
      padding-left: 4px;
    }

    .terms-box {
      width: 100%;
      height: 120px;
      background: #2c2c2c;
      border: 1px solid #333;
      border-radius: 12px;
      padding: 15px;
      margin-bottom: 20px;
      overflow-y: auto;
      box-sizing: border-box;
      font-size: 13px;
      line-height: 1.6;
      color: #ddd;
      text-align: left;
    }

    .terms-box::-webkit-scrollbar {
      width: 8px;
    }
    .terms-box::-webkit-scrollbar-thumb {
      background: #444;
      border-radius: 4px;
    }
    .terms-box::-webkit-scrollbar-track {
      background: transparent;
    }

    .terms-box h4 {
      margin: 15px 0 5px 0;
      color: #fff;
      font-size: 14px;
      border-bottom: 1px solid #444;
      padding-bottom: 3px;
    }
    .terms-box h4:first-child {
      margin-top: 0;
    }

    .terms-box strong {
      color: #fff;
      font-weight: 700;
    }

    .auth-container button.no-hover-effect {
      margin-top: 10px;
    }

    .spinner {
      display: inline-block;
      width: 16px;
      height: 16px;
      border: 3px solid rgba(255, 255, 255, 0.3);
      border-radius: 50%;
      border-top-color: #fff;
      animation: spin 0.8s linear infinite;
      margin-right: 8px;
      vertical-align: middle;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    .error-message {
      color: #ff6b6b;
      font-size: 14px;
      margin-top: -10px;
      margin-bottom: 10px;
      text-align: center;
    }

    .success-message {
      color: #00ff00;
      font-size: 14px;
      margin-top: -10px;
      margin-bottom: 10px;
      text-align: center;
    }

    .footer {
      background: #1e1e1e;
      border-top: 1px solid #333;
      padding: 20px;
      text-align: center;
      color: #666;
      font-size: 12px;
    }

    .tab-container {
      display: flex;
      margin-bottom: 30px;
      border-bottom: 2px solid #333;
    }

    .tab {
      flex: 1;
      padding: 12px;
      text-align: center;
      cursor: pointer;
      color: #aaa;
      font-weight: 600;
      transition: all 0.3s;
      border-bottom: 3px solid transparent;
      margin-bottom: -2px;
    }

    .tab:hover {
      color: #fff;
    }

    .tab.active {
      color: #3663FF;
      border-bottom-color: #3663FF;
    }

    .form-section {
      display: none;
    }

    .form-section.active {
      display: block;
    }

    @media (max-width: 768px) {
      .logo-text {
        font-size: 20px;
      }

      .auth-container {
        padding: 30px 20px;
      }

      .auth-container h2 {
        font-size: 24px;
      }
    }
  </style>
</head>
<body>
  <div class="header">
    <div class="logo-container" onclick="goHome()">
      <img src="logo.svg" alt="Sharer ë¡œê³ " class="logo-svg">
      <span class="logo-text">Sharer</span>
    </div>
  </div>

  <div class="main-content">
    <div class="auth-container">
      <h2>í™˜ì˜í•©ë‹ˆë‹¤!</h2>
      
      <div class="tab-container">
        <div class="tab active" onclick="showTab('login')">ë¡œê·¸ì¸</div>
        <div class="tab" onclick="showTab('signup')">íšŒì›ê°€ì…</div>
      </div>

      <div class="form-section active" id="loginForm">
        <input type="text" id="loginId" placeholder="ì•„ì´ë””">
        <input type="password" id="loginPassword" placeholder="ë¹„ë°€ë²ˆí˜¸">
        <div class="error-message" id="loginError"></div>
        <div class="success-message" id="loginSuccess"></div>
        <button id="loginBtn" onclick="handleLogin()">ë¡œê·¸ì¸</button>
      </div>

      <div class="form-section" id="signupForm">
        
        <div class="terms-label">ì´ìš©ì•½ê´€</div>
        <div class="terms-box">
          <h4>ì œ1ì¡° (ëª©ì )</h4>
          ì´ ì•½ê´€ì€ <strong>ì„œë¹„ìŠ¤ì˜ ì´ìš©ì¡°ê±´ ë° ì ˆì°¨</strong>ì— ê´€í•œ ì‚¬í•­ì„ ê·œì •í•¨ì„ ëª©ì ìœ¼ë¡œ í•©ë‹ˆë‹¤.
          
          <h4>ì œ2ì¡° (ìš©ì–´ì˜ ì •ì˜)</h4>
          1. <strong>"ì„œë¹„ìŠ¤"</strong>ë€ ì›¹ì‚¬ì´íŠ¸ê°€ ì œê³µí•˜ëŠ” ëª¨ë“  ì„œë¹„ìŠ¤ë¥¼ ì˜ë¯¸í•©ë‹ˆë‹¤.<br>
          2. <strong>"íšŒì›"</strong>ì´ë€ ì„œë¹„ìŠ¤ì— ì ‘ì†í•˜ì—¬ ì´ ì•½ê´€ì— ë”°ë¼ ì„œë¹„ìŠ¤ë¥¼ ì´ìš©í•˜ëŠ” ìë¥¼ ë§í•©ë‹ˆë‹¤.
          
          <h4>ì œ3ì¡° (ì„œë¹„ìŠ¤ì˜ ì œê³µ)</h4>
          1. ì„œë¹„ìŠ¤ëŠ” <strong>ì—°ì¤‘ë¬´íœ´, 1ì¼ 24ì‹œê°„ ì œê³µ</strong>í•¨ì„ ì›ì¹™ìœ¼ë¡œ í•©ë‹ˆë‹¤.<br>
          2. ì„œë¹„ìŠ¤ëŠ” ì‹œìŠ¤í…œ ì ê²€ ë“± í•„ìš”í•œ ê²½ìš° ì¼ì‹œì ìœ¼ë¡œ ì¤‘ë‹¨ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
          
          <h4>ì œ4ì¡° (íšŒì›ì˜ ì˜ë¬´)</h4>
          1. íšŒì›ì€ ê´€ê³„ë²•ë ¹, ì´ ì•½ê´€ì˜ ê·œì •, ì´ìš©ì•ˆë‚´ ë° ì„œë¹„ìŠ¤ì™€ ê´€ë ¨í•˜ì—¬ ê³µì§€í•œ ì£¼ì˜ì‚¬í•­ì„ ì¤€ìˆ˜í•˜ì—¬ì•¼ í•©ë‹ˆë‹¤.<br>
          2. íšŒì›ì€ <strong>íƒ€ì¸ì˜ ëª…ì˜ˆë¥¼ ì†ìƒì‹œí‚¤ê±°ë‚˜ ë¶ˆì´ìµì„ ì£¼ëŠ” í–‰ìœ„</strong>ë¥¼ í•´ì„œëŠ” ì•ˆ ë©ë‹ˆë‹¤.
          
          <h4>ì œ5ì¡° (ì„œë¹„ìŠ¤ ì´ìš©ì˜ ì œí•œ)</h4>
          ìš´ì˜ìëŠ” íšŒì›ì´ ì´ ì•½ê´€ì˜ ì˜ë¬´ë¥¼ ìœ„ë°˜í•˜ê±°ë‚˜ ì„œë¹„ìŠ¤ì˜ ì •ìƒì ì¸ ìš´ì˜ì„ ë°©í•´í•œ ê²½ìš°, ì„œë¹„ìŠ¤ ì´ìš©ì„ ì œí•œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.<br><br>
          
          <strong>ë¬¸ì˜ì‚¬í•­:</strong> alexeom97@outlook.com
        </div>

        <div class="terms-label">ê°œì¸ì •ë³´ ì²˜ë¦¬ë°©ì¹¨</div>
        <div class="terms-box">
          <h4>ìˆ˜ì§‘í•˜ëŠ” ê°œì¸ì •ë³´ í•­ëª©</h4>
          <strong>í•„ìˆ˜í•­ëª©:</strong> ì•„ì´ë””, ë¹„ë°€ë²ˆí˜¸, ë‹‰ë„¤ì„
          
          <h4>ê°œì¸ì •ë³´ì˜ ìˆ˜ì§‘ ë° ì´ìš©ëª©ì </h4>
          íšŒì› ê´€ë¦¬, ì„œë¹„ìŠ¤ ì œê³µ, ê²Œì‹œë¬¼ ê´€ë¦¬
          
          <h4>ê°œì¸ì •ë³´ì˜ ë³´ìœ  ë° ì´ìš©ê¸°ê°„</h4>
          <strong>íšŒì› íƒˆí‡´ ì‹œê¹Œì§€</strong>
          
          <h4>ê°œì¸ì •ë³´ íŒŒê¸°ì ˆì°¨ ë° ë°©ë²•</h4>
          ì´ìš©ìì˜ ê°œì¸ì •ë³´ëŠ” ì›ì¹™ì ìœ¼ë¡œ ê°œì¸ì •ë³´ì˜ ìˆ˜ì§‘ ë° ì´ìš©ëª©ì ì´ ë‹¬ì„±ë˜ë©´ <strong>ì§€ì²´ ì—†ì´ íŒŒê¸°</strong>í•©ë‹ˆë‹¤.
          
          <h4>ì´ìš©ìì˜ ê¶Œë¦¬</h4>
          ì´ìš©ìëŠ” ì–¸ì œë“ ì§€ ë³¸ì¸ì˜ ê°œì¸ì •ë³´ë¥¼ ì¡°íšŒí•˜ê±°ë‚˜ ìˆ˜ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.<br><br>
          <strong>ë¬¸ì˜ì‚¬í•­:</strong> alexeom97@outlook.com
        </div>

        <button id="nextBtn" class="no-hover-effect" onclick="handleNextStep()">ë‹¤ìŒìœ¼ë¡œ</button>

      </div>
    </div>
  </div>

  <div class="footer">
    Â© 2025 ã‹¡ê§ì •ë¹ˆ777ê§‚ SNS. All rights reserved.
  </div>

  <script type="module">
    import { createClient } from "https://esm.sh/@supabase/supabase-js@2";
    
    const SUPABASE_URL = "https://hoeevmstbhulbzqyfsug.supabase.co";
    const SUPABASE_PUBLISHABLE_KEY = "sb_publishable_QQCVYix-A8r3vCipAnu0Xg_hST_0xBa";
    
    const supabase = createClient(SUPABASE_URL, SUPABASE_PUBLISHABLE_KEY);

    let verificationCode = "";
    let isVerifying = false;

    window.goHome = function() {
      window.location.href = 'index.html';
    }

    window.showTab = function(tab) {
      const tabs = document.querySelectorAll('.tab');
      const forms = document.querySelectorAll('.form-section');
      
      tabs.forEach(t => t.classList.remove('active'));
      forms.forEach(f => f.classList.remove('active'));
      
      if (tab === 'login') {
        tabs[0].classList.add('active');
        document.getElementById('loginForm').classList.add('active');
      } else {
        tabs[1].classList.add('active');
        document.getElementById('signupForm').classList.add('active');
      }

      document.querySelectorAll('.error-message, .success-message').forEach(el => el.textContent = '');
    }

    window.handleNextStep = function() {
      setTimeout(() => {
        window.location.href = 'https://sharer.jbjb.r-e.kr/join.html';
      }, 300);
    }

    function setButtonLoading(buttonId, isLoading, loadingText = 'ì²˜ë¦¬ ì¤‘...') {
      const button = document.getElementById(buttonId);
      if(!button) return;

      if (isLoading) {
        button.disabled = true;
        button.innerHTML = `<span class="spinner"></span>${loadingText}`;
      } else {
        button.disabled = false;
        if (buttonId === 'loginBtn') {
          button.innerHTML = 'ë¡œê·¸ì¸';
        }
      }
    }

    async function sendVerificationEmail(code) {
      try {
        const response = await fetch('https://api.web3forms.com/submit', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            access_key: 'ee27178a-2f7b-4153-a2b4-01d5905a1280',
            subject: 'ğŸ” ì •ë¹ˆ777 ê°œë°œì ì¸ì¦ ì½”ë“œ',
            from_name: 'ì •ë¹ˆ777 SNS',
            to_email: 'alexeom97@outlook.com',
            message: `â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  ì •ë¹ˆ777 ê°œë°œì ì¸ì¦
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ìš”ì²­í•˜ì‹  ì¸ì¦ ì½”ë“œì…ë‹ˆë‹¤:

    ${code}

ì´ ì½”ë“œë¥¼ SNS ì‚¬ì´íŠ¸ì— ì…ë ¥í•´ì£¼ì„¸ìš”.

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ë³¸ì¸ì´ ìš”ì²­í•˜ì§€ ì•Šì•˜ë‹¤ë©´ ì´ ë©”ì¼ì„ ë¬´ì‹œí•˜ì„¸ìš”.`
          })
        });
        
        const result = await response.json();
        if (result.success) {
          console.log("âœ… ì¸ì¦ ì½”ë“œ ì´ë©”ì¼ ë°œì†¡ ì„±ê³µ!");
          return true;
        } else {
          throw new Error(result.message || "ë°œì†¡ ì‹¤íŒ¨");
        }
      } catch (err) {
        console.error("Email send error:", err);
        console.log("âš ï¸ Verification Code (email failed):", code);
        alert(`ì´ë©”ì¼ ë°œì†¡ ì‹¤íŒ¨. ì½˜ì†”(F12)ì—ì„œ ì¸ì¦ë²ˆí˜¸ë¥¼ í™•ì¸í•˜ì„¸ìš”: ${code}`);
        return true;
      }
    }

    window.handleLogin = async function() {
      const id = document.getElementById('loginId').value.trim();
      const password = document.getElementById('loginPassword').value.trim();
      const errorDiv = document.getElementById('loginError');
      const successDiv = document.getElementById('loginSuccess');

      errorDiv.textContent = '';
      successDiv.textContent = '';

      if (!id || !password) {
        errorDiv.textContent = 'ì•„ì´ë””ì™€ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”.';
        return;
      }

      setButtonLoading('loginBtn', true, 'ë¡œê·¸ì¸ ì¤‘...');

      try {
        if (id === "ì •ë¹ˆ777" && password === "ì •ë¹ˆ777") {
          if (!isVerifying) {
            isVerifying = true;
            verificationCode = Math.floor(100000 + Math.random() * 900000).toString();
            
            document.getElementById('loginId').placeholder = "ì¸ì¦ ì½”ë“œ 6ìë¦¬";
            document.getElementById('loginId').value = "";
            document.getElementById('loginPassword').style.display = "none";
            successDiv.textContent = "ì œì‘ì ì´ë©”ì¼ë¡œ ì¸ì¦ë²ˆí˜¸ë¥¼ ë³´ëƒˆìŠµë‹ˆë‹¤.";
            
            await sendVerificationEmail(verificationCode);
            console.log("Generated code for ì •ë¹ˆ777:", verificationCode);
            setButtonLoading('loginBtn', false);
            return;
          } else {
            if (id === verificationCode) {
              const currentUser = {
                id: "ì •ë¹ˆ777",
                nickname: "JB777",
                isVerified: true
              };
              localStorage.setItem('snsUser', JSON.stringify(currentUser));
              successDiv.textContent = 'ë¡œê·¸ì¸ ì„±ê³µ!';
              setTimeout(() => {
                window.location.href = 'index.html';
              }, 1000);
            } else {
              errorDiv.textContent = "ì¸ì¦ë²ˆí˜¸ê°€ ë§ì§€ ì•ŠìŠµë‹ˆë‹¤.";
              setButtonLoading('loginBtn', false);
            }
            return;
          }
        }

        const { data, error } = await supabase
          .from('users')
          .select('*')
          .eq('id', id)
          .single();
        
        if (error || !data) {
          errorDiv.textContent = 'ì•„ì´ë”” ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.';
          setButtonLoading('loginBtn', false);
          return;
        }

        if (data.password !== password) {
          errorDiv.textContent = 'ì•„ì´ë”” ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.';
          setButtonLoading('loginBtn', false);
          return;
        }

        const currentUser = {
          id: id,
          nickname: data.nickname,
          isVerified: false
        };
        localStorage.setItem('snsUser', JSON.stringify(currentUser));
        successDiv.textContent = 'ë¡œê·¸ì¸ ì„±ê³µ!';
        
        setTimeout(() => {
          window.location.href = 'index.html';
        }, 1000);

      } catch (error) {
        console.error('ë¡œê·¸ì¸ ì˜¤ë¥˜:', error);
        errorDiv.textContent = 'ë¡œê·¸ì¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.';
        setButtonLoading('loginBtn', false);
      }
    }

    document.getElementById('loginPassword').addEventListener('keypress', (e) => {
      if (e.key === 'Enter') handleLogin();
    });
  </script>

<!-- Google Identity Services -->
<script src="https://accounts.google.com/gsi/client" async defer></script>

<div id="g_id_onload"
     data-client_id="â­í•˜ë‚˜ë§Œâ­_CLIENT_ID"
     data-callback="handleCredentialResponse"
     data-auto_prompt="false">
</div>

<div class="g_id_signin"
     data-type="standard"
     data-shape="rectangular"
     data-theme="outline"
     data-size="large">
</div>

<div id="userinfo"></div>

<script>
function handleCredentialResponse(response) {
  const data = parseJwt(response.credential);
  document.getElementById("userinfo").innerHTML =
    `ì•ˆë…•í•˜ì„¸ìš” ${data.name}ë‹˜<br>ì´ë©”ì¼: ${data.email}`;
}

function parseJwt(token) {
  const base64Url = token.split('.')[1];
  const base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');
  return JSON.parse(
    decodeURIComponent(
      atob(base64).split('').map(c =>
        '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2)
      ).join('')
    )
  );
}
</script>




</body>
</html>
